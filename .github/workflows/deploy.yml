# .github/workflows/deploy.yml

name: Deploy Next.js to GitHub Pages

on:
  push:
    branches:
      - main # main ë¸Œëœì¹˜ì— í‘¸ì‹œë  ë•Œë§ˆë‹¤ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      - name: Setup Node ğŸ“¦
        uses: actions/setup-node@v4
        with:
          node-version: 20

      # 1. ì˜ì¡´ì„± ì„¤ì¹˜ ë° Next.js ë¹Œë“œ
      - name: Install dependencies and Build ğŸ—ï¸
        run: |
          # ğŸš¨ 1. Next.js í”„ë¡œì íŠ¸ê°€ ìˆëŠ” ë””ë ‰í† ë¦¬ë¡œ ì´ë™
          cd frontend 
          
          # 2. í•´ë‹¹ ë””ë ‰í† ë¦¬ì—ì„œ ì„¤ì¹˜ ë° ë¹Œë“œ ì‹¤í–‰
          yarn install 
          yarn build
          
      # 2. GH Pagesì— ë°°í¬
      # Next.jsì˜ 'out' ë””ë ‰í† ë¦¬ë¥¼ GitHub Pagesì— ë°°í¬í•©ë‹ˆë‹¤.
      - name: Deploy to GitHub Pages ğŸš€
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./frontend/out # ì •ì  export í›„ ìƒì„±ë˜ëŠ” í´ë”
          publish_branch: gh-pages # gh-pages ë¸Œëœì¹˜ì— ë°°í¬ (ì´ ë¸Œëœì¹˜ë¥¼ Pages ì„¤ì •ì—ì„œ ì‚¬ìš©)
          # cname: yerihyo.com (ë§Œì•½ ì»¤ìŠ¤í…€ ë„ë©”ì¸ì„ ì‚¬ìš©í•œë‹¤ë©´ í™œì„±í™”)
